import{d as ue,g as ie,r as b,s as pe,I as me,U as ce,f as p,K as be,c as j,o as C,i as v,h as e,w as l,m as _,t as g,j as n,M as O,x as U,l as _e,F as ge,A as fe,B as ye,E as ve,am as I}from"./index-SiRIT6sV.js";import{c as K,d as he,e as ke,f as $e}from"./telegram-COMxY2di.js";import{u as z,w as Ce}from"./xlsx-5rFX-EW9.js";const Ve={class:"app-container"},we={type:"border-card",class:"demo-tabs",style:{"min-height":"70vh","margin-top":"10px"}},De={type:"border-card",class:"demo-tabs",style:{"min-height":"70vh","margin-top":"10px"}},xe=ue({name:"user"}),Ye=Object.assign(xe,{setup(qe){const{proxy:s}=ie(),x=b([]),Y=b([]),h=b(!0),f=b(!1),V=b(0),P=b([]),M=b(!0),q=b(""),W=b(1),G=b(15),k=pe({queryParams:{page:0,limit:15,start_date:"",end_date:"",query:""},form:{}}),H=b();H.value=[{status_value:"no",status_name:s.$t("common.no")},{status_value:"yes",status_name:s.$t("common.yes")}];const J=b();J.value=[{status_value:"normal",status_name:s.$t("common.no")},{status_value:"track",status_name:s.$t("common.yes")}];const{queryParams:u,form:i}=me(k),w=o=>{const t=new Date(o),r=t.toLocaleDateString("en-CA"),d=t.toLocaleTimeString("en-CA",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});return`${r}, ${d}`},Q=()=>{const o=new Date,t=z.book_new(),r=z.json_to_sheet(x.value);z.book_append_sheet(t,r,"User Data");const d=`request-history-${o}.xlsx`;Ce(t,d)},y=(o=1)=>{h.value=!0,k.queryParams.status="yes",K(k.queryParams).then(t=>{h.value=!1,x.value=t.data,V.value=t.meta.total})},B=(o=1)=>{h.value=!0,k.queryParams.status="used",K(k.queryParams).then(t=>{h.value=!1,Y.value=t.data,V.value=t.meta.total})},F=o=>{W.value=o,s.$nextTick(()=>{y(o)})},T=o=>{G.value=o,s.$nextTick(()=>{y()})},X=()=>{i.value={name:"",id:void 0}},Z=()=>{X(),f.value=!0,q.value=s.$t("system.Add New")};function ee(o){console.log(o),i.value=o,f.value=!0,q.value="Update Record"}const te=()=>{s.$refs.formRef.validate(o=>{if(o){const r=i.value.phone.split(",").map(d=>({phone:d.trim(),bot_name:i.value.bot_name,status:i.value.status}));i.value.id!==void 0&&i.value.id>0?ke(i.value).then(d=>{f.value=!1,d.statusCode==200?(s.$modal.msgSuccess(s.$t("system.Success")),y()):s.$modal.msgError(s.$t("system.Failed"))}):$e(r).then(d=>{f.value=!1,d.statusCode==200?(s.$modal.msgSuccess(s.$t("system.Success")),y()):s.$modal.msgError(s.$t("system.Failed"))})}})};function ae(o){P.value=o.map(t=>t.id),M.value=!o.length}const le=o=>{ve.confirm("proxy will permanently delete the records. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(()=>{he({id:P.value}),I({type:"success",message:"Delete completed"}),y()}).catch(()=>{I({type:"info",message:"Delete canceled"})})};return ce(()=>{y(),B()}),(o,t)=>{const r=p("el-col"),d=p("el-button"),D=p("el-input"),$=p("el-row"),m=p("el-table-column"),E=p("el-table"),L=p("el-pagination"),N=p("el-tab-pane"),R=p("el-date-picker"),ne=p("el-tabs"),S=p("el-form-item"),oe=p("el-option"),se=p("el-select"),re=p("el-form"),de=p("el-dialog"),A=be("loading");return C(),j("div",Ve,[v("div",null,[e(ne,{type:"border-card",style:{height:"80vh"}},{default:l(()=>[e(N,{label:"Add Phone"},{default:l(()=>[e($,{gutter:24},{default:l(()=>[e(r,{span:4,xs:24},{default:l(()=>t[15]||(t[15]=[v("div",{class:"head-container"},null,-1)])),_:1}),e(r,{lg:24,xm:24},{default:l(()=>[e($,{gutter:10,class:"mb8"},{default:l(()=>[e(r,{span:1.5},{default:l(()=>[e(d,{type:"primary",plain:"",icon:"plus",onClick:Z},{default:l(()=>[_(g(o.$t("btn.add")),1)]),_:1})]),_:1}),e(r,{span:1.5},{default:l(()=>[e(d,{type:"danger",plain:"",icon:"Delete",disabled:n(M),onClick:le},{default:l(()=>[_(g(o.$t("btn.delete")),1)]),_:1},8,["disabled"])]),_:1}),e(r,{span:1.5},{default:l(()=>[e(D,{modelValue:n(u).query,"onUpdate:modelValue":t[0]||(t[0]=a=>n(u).query=a),placeholder:"filter by account , chatid ..",clearable:"",style:{"margin-bottom":"20px"}},null,8,["modelValue"])]),_:1}),e(r,{span:1.5},{default:l(()=>[e(d,{type:"primary",icon:"search",onClick:t[1]||(t[1]=a=>y(1))},{default:l(()=>[_(g(o.$t("btn.search")),1)]),_:1})]),_:1})]),_:1}),v("div",we,[O((C(),U(E,{data:n(x),onSelectionChange:ae},{default:l(()=>[e(m,{type:"selection",width:"50",align:"center"}),e(m,{label:"Number",align:"left",sortable:"",key:"phone",prop:"phone"}),e(m,{label:"Bot name",align:"center",sortable:"",key:"bot_name",prop:"bot_name"}),e(m,{label:n(s).$t("lables.status"),align:"center",sortable:"",key:"status",prop:"status"},null,8,["label"]),e(m,{label:n(s).$t("lables.created_on"),align:"center",key:"created_at",prop:"created_at"},{default:l(a=>{var c;return[_(g(w((c=a==null?void 0:a.row)==null?void 0:c.created_at)),1)]}),_:1},8,["label"]),e(m,{label:n(s).$t("lables.updated_on"),align:"center",key:"updated_at",prop:"updated_at"},{default:l(a=>{var c;return[_(g(w((c=a==null?void 0:a.row)==null?void 0:c.updated_at)),1)]}),_:1},8,["label"]),e(m,{label:n(s).$t("action"),align:"right","class-name":"small-padding fixed-width"},{default:l(a=>[e(d,{type:"primary",size:"small",icon:"edit",title:o.$t("btn.edit"),onClick:_e(c=>ee(a.row),["stop"])},null,8,["title","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[A,n(h)]])]),t[16]||(t[16]=v("br",null,null,-1)),e(L,{"current-page":n(u).page,"onUpdate:currentPage":t[2]||(t[2]=a=>n(u).page=a),"page-size":n(u).limit,"onUpdate:pageSize":t[3]||(t[3]=a=>n(u).limit=a),"page-sizes":[15,20,30,40,50,60,70,80,90,100,120],small:!0,disabled:o.disabled,background:o.background,layout:"total, sizes, prev, pager, next, jumper",total:n(V),onSizeChange:F,onCurrentChange:T},null,8,["current-page","page-size","disabled","background","total"])]),_:1})]),_:1})]),_:1}),e(N,{label:"History","tab-click":"loadListHistory"},{default:l(()=>[e($,{gutter:24},{default:l(()=>[e(r,{span:4,xs:24},{default:l(()=>t[17]||(t[17]=[v("div",{class:"head-container"},null,-1)])),_:1}),e(r,{lg:24,xm:24},{default:l(()=>[e($,{gutter:10,class:"mb8"},{default:l(()=>[e(r,{span:1.5},{default:l(()=>[e(d,{type:"primary",plain:"",icon:"UploadFilled",onClick:Q},{default:l(()=>[_(g(o.$t("btn.export")),1)]),_:1})]),_:1}),e(r,{span:1.5},{default:l(()=>[e(R,{modelValue:n(u).start_date,"onUpdate:modelValue":t[4]||(t[4]=a=>n(u).start_date=a),type:"datetime",placeholder:"From Date",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(r,{span:1.5},{default:l(()=>[e(R,{modelValue:n(u).end_date,"onUpdate:modelValue":t[5]||(t[5]=a=>n(u).end_date=a),type:"datetime",placeholder:"To Date",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(r,{span:1.5},{default:l(()=>[e(D,{modelValue:n(u).query,"onUpdate:modelValue":t[6]||(t[6]=a=>n(u).query=a),placeholder:"filter phone ..",clearable:"",style:{"margin-bottom":"20px"}},null,8,["modelValue"])]),_:1}),e(r,{span:1.5},{default:l(()=>[e(d,{type:"primary",icon:"search",onClick:t[7]||(t[7]=a=>B(1))},{default:l(()=>[_(g(o.$t("btn.search")),1)]),_:1})]),_:1})]),_:1}),v("div",De,[O((C(),U(E,{data:n(Y)},{default:l(()=>[e(m,{label:"Number",align:"left",sortable:"",key:"phone",prop:"phone"}),e(m,{label:"Bot name",align:"center",sortable:"",key:"bot_name",prop:"bot_name"}),e(m,{label:"Request",align:"center",sortable:"",key:"requester",prop:"requester"}),e(m,{label:"Request",align:"center",sortable:"",key:"request_date",prop:"request_date"}),e(m,{label:n(s).$t("lables.status"),align:"center",key:"status",prop:"status"},null,8,["label"]),e(m,{label:n(s).$t("lables.created_on"),align:"center",key:"created_at",prop:"created_at"},{default:l(a=>{var c;return[_(g(w((c=a==null?void 0:a.row)==null?void 0:c.created_at)),1)]}),_:1},8,["label"]),e(m,{label:n(s).$t("lables.updated_on"),align:"center",key:"updated_at",prop:"updated_at"},{default:l(a=>{var c;return[_(g(w((c=a==null?void 0:a.row)==null?void 0:c.updated_at)),1)]}),_:1},8,["label"])]),_:1},8,["data"])),[[A,n(h)]])]),t[18]||(t[18]=v("br",null,null,-1)),e(L,{"current-page":n(u).page,"onUpdate:currentPage":t[8]||(t[8]=a=>n(u).page=a),"page-size":n(u).limit,"onUpdate:pageSize":t[9]||(t[9]=a=>n(u).limit=a),"page-sizes":[15,20,30,40,50,60,70,80,90,100,120],small:!0,disabled:o.disabled,background:o.background,layout:"total, sizes, prev, pager, next, jumper",total:n(V),onSizeChange:F,onCurrentChange:T},null,8,["current-page","page-size","disabled","background","total"])]),_:1})]),_:1})]),_:1})]),_:1}),e(de,{title:n(q),modelValue:n(f),"onUpdate:modelValue":t[14]||(t[14]=a=>ye(f)?f.value=a:null),width:"600px","append-to-body":"","close-on-click-modal":!1,draggable:""},{footer:l(()=>[e(d,{text:"",onClick:t[13]||(t[13]=a=>f.value=!1)},{default:l(()=>[_(g(o.$t("btn.cancel")),1)]),_:1}),e(d,{type:"primary",onClick:te},{default:l(()=>[_(g(o.$t("btn.submit")),1)]),_:1})]),default:l(()=>[e(re,{ref:"formRef",model:n(i),rules:o.rules,"label-width":"100px"},{default:l(()=>[e($,null,{default:l(()=>[e(r,{lg:24},{default:l(()=>[e(S,{label:"Phone",prop:"phone"},{default:l(()=>[e(D,{modelValue:n(i).phone,"onUpdate:modelValue":t[10]||(t[10]=a=>n(i).phone=a),rows:8,type:"textarea",placeholder:"049485495,012375868,...."},null,8,["modelValue"])]),_:1}),e(S,{label:"Telegram Bot:",prop:"bot_name"},{default:l(()=>[e(D,{modelValue:n(i).bot_name,"onUpdate:modelValue":t[11]||(t[11]=a=>n(i).bot_name=a),placeholder:n(s).$t("system.Enter")},null,8,["modelValue","placeholder"])]),_:1}),e(S,{label:n(s).$t("lables.status"),prop:"status"},{default:l(()=>[e(se,{modelValue:n(i).status,"onUpdate:modelValue":t[12]||(t[12]=a=>n(i).status=a),placeholder:"Select",style:{width:"150px"}},{default:l(()=>[(C(!0),j(ge,null,fe(n(H),a=>(C(),U(oe,{key:a.status_value,label:a.status_name,value:a.status_value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])])}}});export{Ye as default};
